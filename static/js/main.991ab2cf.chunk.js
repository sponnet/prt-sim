(this["webpackJsonpcs-sim"]=this["webpackJsonpcs-sim"]||[]).push([[0],{165:function(a,t,e){"use strict";e.r(t);var s=e(0),l=e.n(s),r=e(50),o=e.n(r),i=(e(58),e(4)),n=e(5),c=e(7),m=e(6),h=e(8),p=(e(59),e(60),e(31),function(a){function t(a){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(m.a)(t).call(this))).state={globalparams:a.globalparams||{}},e.onChange=a.onChange,e}return Object(h.a)(t,a),Object(n.a)(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var a=this,t=function(t,e,s,r,o,i,n){var c=1/i,m=function(t){if(a.state.globalparams[e]===t)return t;var s=Object.assign({},a.state.globalparams);return s[e]=t/c,a.setState({globalparams:s},(function(){a.onChange&&a.onChange(s)})),t},h=a.state.globalparams[e]||m(n/i);return l.a.createElement("article",{className:"tile is-child box"},l.a.createElement("p",{className:"title"},t," "),l.a.createElement("p",{className:"subtitle"},l.a.createElement("input",{className:"slider is-fullwidth is-large is-danger is-circle",step:"1",min:r*c,max:o*c,value:h*c,type:"range",onChange:function(a){m(a.target.value)}}),l.a.createElement("br",null),e," = ",h," ",s))};return l.a.createElement("div",{className:"container"},l.a.createElement("section",{className:"info-tiles"},l.a.createElement("p",null,"Belt transmission & rear wheel parameters"),l.a.createElement("div",{className:"tile is-ancestor has-text-centered"},l.a.createElement("div",{className:"tile is-parent"},t("belt thickness","h","mm",.1,5,.1,2.2),t("belt length","L","m",1,50,.1,20),t("Diameter hub motor","D0","mm",1,100,1,10),t("Diameter hub wheel","D2","mm",1,200,1,60),t("Diameter rear wheel","RWD","mm",10,1e3,1,180))),l.a.createElement("p",null,"Motor"),l.a.createElement("div",{className:"tile is-ancestor has-text-centered"},l.a.createElement("div",{className:"tile is-parent"},t("average RPM","rpm","rpm",100,8e3,100,3500),t("Track length","Lt","m",10,30,1,20)))))}}]),t}(s.Component)),b=e(51),g=e(29),u=e.n(g),d=function(a){function t(a){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(m.a)(t).call(this))).state={globalparams:a.globalparams,proposal:a.proposal,currenttime:0,timeline:void 0,plot:void 0},e}return Object(h.a)(t,a),Object(n.a)(t,[{key:"componentWillMount",value:function(){this.recalc([]),this.restart()}},{key:"componentWillReceiveProps",value:function(a){var t=this;console.log("New params",a.globalparams),this.setState({globalparams:a.globalparams},(function(){t.recalc([])}))}},{key:"makecolor",value:function(a){var t=7*a*251%255,e=7*a*43%255;return"rgba(".concat(7*a*139%255,",").concat(t,",").concat(e,",0.3)")}},{key:"restart",value:function(){var a=this;this.setState({currenttime:0,convictiontresholdpassed:!1},(function(){var t=setInterval((function(){var e=a.state.currenttime+1;console.log("tick",e),a.state.globalparams.tl>a.state.currenttime&&!a.state.convictiontresholdpassed?a.setState({currenttime:e},(function(){a.recalc([])})):(clearInterval(t),a.state.convictiontresholdpassed?a.recalc([{t:a.state.currenttime,desc:"Proposal passed !"}]):a.recalc([[{t:a.state.currenttime,desc:"Proposal did not pass before end of sim"}]]))}),1)}))}},{key:"recalc",value:function(){if(console.log("Recalc"),this.state.globalparams&&this.state.globalparams.h&&this.state.globalparams.L&&this.state.globalparams.D0&&this.state.globalparams.D2&&this.state.globalparams.RWD){for(var a=this.state.globalparams.L/100,t=[],e=0;e<=this.state.globalparams.L;e+=a)t.push(Math.floor(e));for(var s=[],l=[],r=[],o=[],i=[],n=[],c=[],m=[],h=[],p=[],b=1e3*this.state.globalparams.L,g=(this.state.globalparams.h-this.state.globalparams.D2+Math.sqrt((this.state.globalparams.D2-this.state.globalparams.h)*(this.state.globalparams.D2-this.state.globalparams.h)+4*this.state.globalparams.h*b/Math.PI))/(2*this.state.globalparams.h),d=0,v=0,f=0;f<=this.state.globalparams.L;f+=a){var E=1e3*f,k=(this.state.globalparams.h-this.state.globalparams.D0+Math.sqrt((this.state.globalparams.D0-this.state.globalparams.h)*(this.state.globalparams.D0-this.state.globalparams.h)+4*this.state.globalparams.h*E/Math.PI))/(2*this.state.globalparams.h),D=1e3*(this.state.globalparams.L-f),w=(this.state.globalparams.h-this.state.globalparams.D2+Math.sqrt((this.state.globalparams.D2-this.state.globalparams.h)*(this.state.globalparams.D2-this.state.globalparams.h)+4*this.state.globalparams.h*D/Math.PI))/(2*this.state.globalparams.h),N=(g-w)*this.state.globalparams.RWD*Math.PI,y=k/this.state.globalparams.rpm*60;l.push(k),i.push(w),s.push(f),o.push(this.state.globalparams.L-f);var C=2*k*this.state.globalparams.h+this.state.globalparams.D0,j=2*w*this.state.globalparams.h+this.state.globalparams.D2;if(0===f){p.push(new u.a.paths.Circle([0,0],this.state.globalparams.D0)),p.push({type:"circle",origin:[0,0],radius:j});var O=2*j+20;p.push({type:"circle",origin:[O,0],radius:j}),p.push({type:"circle",origin:[O,0],radius:this.state.globalparams.D2})}r.push(C),n.push(j),c.push(N/1e3),m.push(0===j?void 0:C/j),h.push(y),!d&&N>1e3*this.state.globalparams.Lt&&(d=y,v=N/1e3)}var M=0;this.setState({winning_time:d,winning_distance:v,plots:[{labels:t,datasets:[{label:"gear ratio",fill:!1,borderColor:this.makecolor(M++),data:m}]},{labels:t,datasets:[{label:"distance traveled (m)",fill:!1,borderColor:this.makecolor(M++),data:c}]},{labels:t,datasets:[{label:"rotations on spool 1 (motor)",fill:!1,borderColor:this.makecolor(M++),data:l},{label:"rotations on spool 2 (wheel)",fill:!1,borderColor:this.makecolor(M++),data:i},{label:"spool 1 outer diameter",fill:!1,borderColor:this.makecolor(M++),data:r},{label:"spool 2 outer diameter",fill:!1,borderColor:this.makecolor(M++),data:n}]}]});var L=u.a.exporter.toSVG(p);this.setState({svg:L})}else console.log("Not enough parameters to run sim",this.state.globalparams)}},{key:"render",value:function(){var a=this;return l.a.createElement("div",{className:""},l.a.createElement("div",{className:"tile is-ancestor has-text-centered"},l.a.createElement("div",{className:"tile is-parent"},this.state.plots&&this.state.plots.map((function(a,t){return l.a.createElement("div",{className:"tile is-child box"},l.a.createElement(b.a,{key:t,data:a}))})))),this.state.winning_time?l.a.createElement(l.a.Fragment,null,l.a.createElement("p",{className:"card-header-title"},"Winning time : ",this.state.winning_time,"s"),l.a.createElement("p",{className:"card-header-title"},"Distance traveled : ",this.state.winning_distance,"s")):l.a.createElement("p",null,"You will never finish"),this.state.svg&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.svg}})),l.a.createElement("button",{onClick:function(){a.restart()}},"Restart Simulation"))}}]),t}(s.Component),v=(s.Component,function(a){function t(a){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(m.a)(t).call(this))).state={globalparams:{}},e}return Object(h.a)(t,a),Object(n.a)(t,[{key:"timeChanged",value:function(a){console.log("app: time changed")}},{key:"render",value:function(){var a=this;return l.a.createElement("div",{className:"App"},l.a.createElement("section",{className:"hero is-info welcome"},l.a.createElement("div",{className:"hero-body"},l.a.createElement("div",{className:"container"},l.a.createElement("h1",{className:"header-1"},"Powertool beltgear simulator")))),l.a.createElement(p,{globalparams:this.state.globalparams,onChange:function(t){a.setState({globalparams:t})}}),l.a.createElement(d,{globalparams:this.state.globalparams}))}}]),t}(s.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(a){a.unregister()}))},31:function(a,t,e){},53:function(a,t,e){a.exports=e(165)},58:function(a,t,e){},59:function(a,t,e){a.exports=e.p+"static/media/logo.5d5d9eef.svg"}},[[53,1,2]]]);
//# sourceMappingURL=main.991ab2cf.chunk.js.map