(this["webpackJsonpcs-sim"]=this["webpackJsonpcs-sim"]||[]).push([[0],{194:function(a,t,e){"use strict";e.r(t);var s=e(0),l=e.n(s),r=e(60),o=e.n(r),n=(e(71),e(8)),i=e(9),c=e(11),m=e(10),h=e(12),p=(e(72),e(73),e(42),e(26)),u=e.n(p),g=function(a){function t(a){var e;Object(n.a)(this,t),e=Object(c.a)(this,Object(m.a)(t).call(this));var s=u.a.parse(a.location.search,{ignoreQueryPrefix:!0});return e.history=a.history,e.state={globalparams:s||{},history:a.history},e.onChange=a.onChange,e}return Object(h.a)(t,a),Object(i.a)(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var a=this,t=function(t,e,s,r,o,n,i){var c=1/n,m=function(t){if(a.state.globalparams[e]===t)return t;var s=Object.assign({},a.state.globalparams);return s[e]=t/c,a.setState({globalparams:s},(function(){var t=u.a.stringify(s);console.log(t),console.log(a.state),a.history&&a.history.push({search:"?"+t}),a.onChange&&a.onChange(s)})),t},h=a.state.globalparams[e]||m(i/n);return l.a.createElement("article",{className:"tile is-child box"},l.a.createElement("p",{className:"title"},t," "),l.a.createElement("p",{className:"subtitle"},l.a.createElement("input",{className:"slider is-fullwidth is-large is-danger is-circle",step:"1",min:r*c,max:o*c,value:h*c,type:"range",onChange:function(a){m(a.target.value)}}),l.a.createElement("br",null),e," = ",h," ",s))};return l.a.createElement("div",{className:"container"},l.a.createElement("section",{className:"info-tiles"},l.a.createElement("p",null,"Belt transmission & rear wheel parameters"),l.a.createElement("div",{className:"tile is-ancestor has-text-centered"},l.a.createElement("div",{className:"tile is-parent"},t("belt thickness","h","mm",.1,5,.1,2.2),t("belt length","L","m",1,50,.1,20),t("Diameter hub motor","D0","mm",1,100,1,10),t("Diameter hub wheel","D2","mm",1,200,1,60),t("Diameter rear wheel","RWD","mm",10,1e3,1,180))),l.a.createElement("p",null,"Motor"),l.a.createElement("div",{className:"tile is-ancestor has-text-centered"},l.a.createElement("div",{className:"tile is-parent"},t("average RPM","rpm","rpm",100,8e3,100,3500),t("Track length","Lt","m",10,30,1,18.48)))))}}]),t}(s.Component),b=e(61),d=e(38),v=e.n(d),f=function(a){function t(a){var e;return Object(n.a)(this,t),(e=Object(c.a)(this,Object(m.a)(t).call(this))).history=a.history,e.state={globalparams:a.globalparams,proposal:a.proposal,currenttime:0,timeline:void 0,plot:void 0},e}return Object(h.a)(t,a),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.recalc([]),this.restart()}},{key:"componentWillReceiveProps",value:function(a){var t=this;this.setState({globalparams:a.globalparams},(function(){t.recalc([])}))}},{key:"makecolor",value:function(a){var t=7*a*251%255,e=7*a*43%255;return"rgba(".concat(7*a*139%255,",").concat(t,",").concat(e,",0.3)")}},{key:"restart",value:function(){var a=this;this.setState({currenttime:0,convictiontresholdpassed:!1},(function(){var t=setInterval((function(){var e=a.state.currenttime+1;console.log("tick",e),a.state.globalparams.tl>a.state.currenttime&&!a.state.convictiontresholdpassed?a.setState({currenttime:e},(function(){a.recalc([])})):(clearInterval(t),a.state.convictiontresholdpassed?a.recalc([{t:a.state.currenttime,desc:"Proposal passed !"}]):a.recalc([[{t:a.state.currenttime,desc:"Proposal did not pass before end of sim"}]]))}),1)}))}},{key:"recalc",value:function(){if(console.log("Recalc"),this.state.globalparams&&this.state.globalparams.h&&this.state.globalparams.L&&this.state.globalparams.D0&&this.state.globalparams.D2&&this.state.globalparams.RWD){for(var a=this.state.globalparams.L/100,t=[],e=0;e<=this.state.globalparams.L;e+=a)t.push(Math.floor(e));for(var s=[],l=[],r=[],o=[],n=[],i=[],c=[],m=[],h=[],p=[],u=1e3*this.state.globalparams.L,g=(this.state.globalparams.h-this.state.globalparams.D2+Math.sqrt((this.state.globalparams.D2-this.state.globalparams.h)*(this.state.globalparams.D2-this.state.globalparams.h)+4*this.state.globalparams.h*u/Math.PI))/(2*this.state.globalparams.h),b=0,d=0,f=0;f<=this.state.globalparams.L;f+=a){var E=1e3*f,y=(this.state.globalparams.h-this.state.globalparams.D0+Math.sqrt((this.state.globalparams.D0-this.state.globalparams.h)*(this.state.globalparams.D0-this.state.globalparams.h)+4*this.state.globalparams.h*E/Math.PI))/(2*this.state.globalparams.h),k=1e3*(this.state.globalparams.L-f),D=(this.state.globalparams.h-this.state.globalparams.D2+Math.sqrt((this.state.globalparams.D2-this.state.globalparams.h)*(this.state.globalparams.D2-this.state.globalparams.h)+4*this.state.globalparams.h*k/Math.PI))/(2*this.state.globalparams.h),w=(g-D)*this.state.globalparams.RWD*Math.PI,N=y/this.state.globalparams.rpm*60;l.push(y),n.push(D),s.push(f),o.push(this.state.globalparams.L-f);var C=2*y*this.state.globalparams.h+this.state.globalparams.D0,j=2*D*this.state.globalparams.h+this.state.globalparams.D2;if(0===f){p.push(new v.a.paths.Circle([0,0],this.state.globalparams.D0)),p.push({type:"circle",origin:[0,0],radius:j});var O=2*j+20;p.push({type:"circle",origin:[O,0],radius:j}),p.push({type:"circle",origin:[O,0],radius:this.state.globalparams.D2})}r.push(C),i.push(j),c.push(w/1e3),m.push(0===j?void 0:C/j),h.push(N),!b&&w>1e3*this.state.globalparams.Lt&&(b=N,d=w/1e3)}var M=0;this.setState({winning_time:b,winning_distance:d,plots:[{labels:t,datasets:[{label:"gear ratio",fill:!1,borderColor:this.makecolor(M++),data:m}]},{labels:t,datasets:[{label:"distance traveled (m)",fill:!1,borderColor:this.makecolor(M++),data:c}]},{labels:t,datasets:[{label:"rotations on spool 1 (motor)",fill:!1,borderColor:this.makecolor(M++),data:l},{label:"rotations on spool 2 (wheel)",fill:!1,borderColor:this.makecolor(M++),data:n},{label:"spool 1 outer diameter",fill:!1,borderColor:this.makecolor(M++),data:r},{label:"spool 2 outer diameter",fill:!1,borderColor:this.makecolor(M++),data:i}]}]});var x=v.a.exporter.toSVG(p);this.setState({svg:x})}else console.log("Not enough parameters to run sim",this.state.globalparams)}},{key:"render",value:function(){var a=this;return l.a.createElement("div",{className:""},l.a.createElement("div",{className:"tile is-ancestor has-text-centered"},l.a.createElement("div",{className:"tile is-parent"},this.state.plots&&this.state.plots.map((function(a,t){return l.a.createElement("div",{className:"tile is-child box"},l.a.createElement(b.a,{key:t,data:a}))})))),this.state.winning_time?l.a.createElement(l.a.Fragment,null,l.a.createElement("p",{className:"card-header-title"},"Winning time : ",this.state.winning_time,"s"),l.a.createElement("p",{className:"card-header-title"},"Distance traveled : ",this.state.winning_distance,"s")):l.a.createElement("p",null,"You will never finish"),this.state.svg&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.svg}})),l.a.createElement("button",{onClick:function(){a.restart()}},"Restart Simulation"))}}]),t}(s.Component),E=(s.Component,e(63)),y=e(13),k="".concat("/prt-sim","/"),D=function(a){function t(a){var e;return Object(n.a)(this,t),(e=Object(c.a)(this,Object(m.a)(t).call(this))).state={globalparams:{}},e}return Object(h.a)(t,a),Object(i.a)(t,[{key:"timeChanged",value:function(a){console.log("app: time changed")}},{key:"render",value:function(){var a=this;return l.a.createElement("div",{className:"App"},l.a.createElement(E.a,null,l.a.createElement(y.c,null,l.a.createElement(y.a,{key:k,path:k,exact:"/"===k,render:function(t){return l.a.createElement(l.a.Fragment,null,l.a.createElement("section",{className:"hero is-info welcome"},l.a.createElement("div",{className:"hero-body"},l.a.createElement("div",{className:"container"},l.a.createElement("h1",{className:"header-1"},"Powertool beltgear simulator")))),l.a.createElement(g,Object.assign({globalparams:a.state.globalparams,onChange:function(t){a.setState({globalparams:t})}},t)),l.a.createElement(f,Object.assign({globalparams:a.state.globalparams},t)))}}))))}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(a){a.unregister()}))},42:function(a,t,e){},66:function(a,t,e){a.exports=e(194)},71:function(a,t,e){},72:function(a,t,e){a.exports=e.p+"static/media/logo.5d5d9eef.svg"}},[[66,1,2]]]);
//# sourceMappingURL=main.9932d294.chunk.js.map